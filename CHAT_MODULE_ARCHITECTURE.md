# Архитектура модуля "Чат с ИИ"

## Обзор

Модуль "Чат с ИИ" был полностью переработан и разбит на функциональные компоненты для улучшения поддерживаемости, читаемости и расширяемости кода.

## Структура модулей

```
frontend/src/components/
├── ChatInterface.js          # Главный компонент-контейнер
└── chat/                     # Директория модулей чата
    ├── ChatHeader.js         # Заголовок с управлением
    ├── ChatMessages.js       # Отображение сообщений
    ├── ChatInput.js          # Ввод сообщений и файлов
    └── ChatSettings.js       # Модальное окно настроек
```

## Функциональные модули

### 1. ChatInterface.js (Главный контейнер)
**Роль**: Координирует работу всех модулей чата
**Функции**:
- Управление состоянием настроек (temperature, maxTokens)
- Передача пропсов между модулями
- Обработка сброса настроек

### 2. ChatHeader.js (Заголовок чата)
**Роль**: Отображает заголовок и элементы управления
**Функции**:
- Выбор модели ИИ (ModelSelector)
- Переключение турбо режима
- Выбор глубины рассуждения
- Кнопки "Настройки" и "Удалить чат"

### 3. ChatMessages.js (Сообщения)
**Роль**: Отображает историю сообщений
**Функции**:
- Рендеринг сообщений пользователя и ИИ
- Отображение метаданных (токены, время, режимы)
- Автопрокрутка к новым сообщениям
- Индикатор загрузки

### 4. ChatInput.js (Ввод сообщений)
**Роль**: Обрабатывает ввод текста и файлов
**Функции**:
- Ввод текстовых сообщений
- Загрузка и прикрепление файлов
- Валидация типов и размеров файлов
- Отображение прогресса загрузки
- Обработка ошибок

### 5. ChatSettings.js (Настройки)
**Роль**: Модальное окно с настройками чата
**Функции**:
- Управление турбо режимом
- Выбор глубины рассуждения
- Настройка температуры (креативность)
- Настройка максимального количества токенов
- Сброс настроек к значениям по умолчанию

## Преимущества модульной архитектуры

### 1. Разделение ответственности
- Каждый модуль отвечает за свою функциональность
- Упрощение тестирования и отладки
- Легкость внесения изменений

### 2. Переиспользование компонентов
- Модули можно использовать в других частях приложения
- Упрощение создания новых функций

### 3. Улучшенная читаемость
- Код разбит на логические блоки
- Упрощение понимания архитектуры

### 4. Масштабируемость
- Легкое добавление новых функций
- Простое расширение существующих модулей

## Интеграция с существующей системой

### Пропсы и состояние
Все модули получают необходимые данные через пропсы от главного компонента `ChatInterface`, который в свою очередь получает их от `ChatPage` и `App.js`.

### Стилизация
Все модули используют единую систему стилей:
- Tailwind CSS с кастомными классами
- Градиенты и анимации
- Адаптивный дизайн

### Обработка событий
События обрабатываются через callback-функции, передаваемые от родительских компонентов:
- `onSendMessage` - отправка сообщения
- `onSendMessageWithFile` - отправка файла
- `onTurboModeChange` - изменение турбо режима
- `onReasoningDepthChange` - изменение глубины рассуждения

## Новые возможности

### 1. Расширенные настройки
- Настройка температуры для контроля креативности
- Выбор максимального количества токенов
- Сброс настроек к значениям по умолчанию

### 2. Улучшенный UX
- Модальное окно настроек с интуитивным интерфейсом
- Визуальные индикаторы режимов работы
- Улучшенная обработка ошибок

### 3. Лучшая организация кода
- Четкое разделение логики
- Упрощенное тестирование
- Легкость внесения изменений

## Заключение

Модульная архитектура чата значительно улучшает поддерживаемость и расширяемость кода, обеспечивая при этом лучший пользовательский опыт и более интуитивное управление настройками.
