# –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ BGE-M3

## üìã –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

**–ú–æ–¥–µ–ª—å BGE-M3 –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è** - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.

## üîç –î–µ—Ç–∞–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
1. **RAG —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω** ‚úÖ
2. **–ú–æ–¥–µ–ª—å BGE-M3 –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ** ‚úÖ
3. **SentenceTransformer –∑–∞–≥—Ä—É–∂–∞–µ—Ç BAAI/bge-m3** üîÑ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)

### –õ–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏:
```
INFO:services.rag_service:ü§ñ [EMBEDDING_MODEL] Loading BGE-M3 model...
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: BAAI/bge-m3
```

## ‚è±Ô∏è –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

### –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è:
- **–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: 5-15 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
- **–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏**: 1-2 –º–∏–Ω—É—Ç—ã (–º–æ–¥–µ–ª—å –∫—ç—à–∏—Ä—É–µ—Ç—Å—è)

### –§–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å:
- –°–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏ (~2-3 GB)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ RAG —Å–µ—Ä–≤–∏—Å–∞:
```bash
docker-compose restart rag-service
```

### 2. –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏:
```bash
curl -X POST "https://localhost/api/ntd-consultation/chat" \
  -H "Content-Type: application/json" \
  -d '{"message": "–ß—Ç–æ —Ç–∞–∫–æ–µ –ì–û–°–¢?", "user_id": "default_user", "history": []}' \
  -k
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞:
```bash
docker-compose logs rag-service --tail=20
```

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

- ‚úÖ RAG —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- ‚úÖ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ù–¢–î –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –ú–æ–¥–µ–ª—å BGE-M3 –Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

## üîÑ –ß—Ç–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

- üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ BGE-M3
- üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SentenceTransformer
- üîÑ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:**
```bash
docker-compose logs rag-service --tail=10
```

2. **–¢–µ—Å—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ (—Å —Ç–∞–π–º–∞—É—Ç–æ–º):**
```bash
curl -X POST "https://localhost/api/ntd-consultation/chat" \
  -H "Content-Type: application/json" \
  -d '{"message": "–¢–µ—Å—Ç", "user_id": "default_user", "history": []}' \
  -k --max-time 60
```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫:**
```bash
docker-compose logs rag-service --tail=50 | grep -E "(ERROR|WARN|Downloading|Loading)"
```

## üéØ –ü—Ä–∏–∑–Ω–∞–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏

### –ö–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è, –≤—ã —É–≤–∏–¥–∏—Ç–µ:
1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤** –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
2. **–£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã** –æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ `/api/ntd-consultation/chat`
3. **–õ–æ–≥–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è** –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏

### –ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:
```json
{
  "status": "success",
  "response": "–ù–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∏—Å–∫–∞ –≤ –±–∞–∑–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...",
  "sources": [...],
  "confidence": 0.8,
  "documents_used": 3,
  "timestamp": "2025-08-30T17:45:00.000000"
}
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏:
1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é** —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
2. **–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã** –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∏—Å–∫** –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- **–ù–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å** –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
- **–î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** üîÑ –ú–û–î–ï–õ–¨ –ó–ê–ì–†–£–ñ–ê–ï–¢–°–Ø

–ú–æ–¥–µ–ª—å BGE-M3 —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ. –ü—Ä–æ—Ü–µ—Å—Å –∏–¥–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ (5-15 –º–∏–Ω—É—Ç –¥–ª—è –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏).

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ù–¢–î —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–∏—Å–∫–æ–º –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º.
