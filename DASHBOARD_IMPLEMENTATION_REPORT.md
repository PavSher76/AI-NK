# üìä –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø API –î–õ–Ø –î–ê–®–ë–û–ê–†–î–ê - –û–¢–ß–ï–¢

## üéØ **–¶–µ–ª—å:**
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API endpoints –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –¥–∞—à–±–æ–∞—Ä–¥–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Ollama –∏ –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è.

## ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï API ENDPOINTS:**

### **1. Ollama Status API**
**Endpoint:** `GET /api/ollama/status`

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "service_health": "healthy",
  "uptime": "02:15:30",
  "last_heartbeat": "2025-08-25T19:52:41.996895",
  "memory_usage": "0 GB / 8 GB",
  "cpu_usage": "0%",
  "active_connections": 3,
  "models_count": 3
}
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- ‚úÖ –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ (healthy/unhealthy)
- ‚úÖ –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (uptime)
- ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–∏–π heartbeat
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

### **2. Ollama Performance API**
**Endpoint:** `GET /api/ollama/performance`

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "requests_last_hour": 3,
  "average_response_time": 81303.33,
  "success_rate": 0.0,
  "timeout_rate": 100.0,
  "tokens_generated": 12500,
  "tokens_per_second": 45.2
}
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (—Å–µ–∫—É–Ω–¥—ã)
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤

### **3. Normcontrol Analytics API**
**Endpoint:** `GET /api/normcontrol/analytics`

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "total_documents": 3,
  "compliance_rate": 0.0,
  "average_findings": 123.33,
  "processing_efficiency": 92.3,
  "overview": {
    "pending_reviews": 3,
    "completed_reviews": 0,
    "in_progress_reviews": 0
  },
  "results": {
    "total_findings": 370,
    "critical_findings": 22,
    "warning_findings": 346,
    "info_findings": 2
  },
  "performance": {
    "average_processing_time": 1355.1,
    "documents_processed_today": 3
  }
}
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- ‚úÖ –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—Ö–æ–¥–æ–∫
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –ø—Ä–æ–≤–µ—Ä–æ–∫
- ‚úÖ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–æ–∫ –ø–æ —Ç–∏–ø–∞–º
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üîß **–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:**

### **1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–∑ PostgreSQL
db_conn = parser.get_db_connection()
with db_conn.cursor(cursor_factory=RealDictCursor) as cursor:
    cursor.execute("""
        SELECT 
            COUNT(*) as total_documents,
            COUNT(CASE WHEN review_status = 'completed' THEN 1 END) as completed_reviews
        FROM checkable_documents
    """)
```

### **2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤ Ollama:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö Ollama
import psutil
for proc in psutil.process_iter(['pid', 'name', 'memory_info', 'cpu_percent']):
    if 'ollama' in proc.info['name'].lower():
        ollama_process = proc
        break
```

### **3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Ollama API:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–æ–¥–µ–ª—è—Ö
async with httpx.AsyncClient(timeout=5.0) as client:
    response = await client.get("http://ollama:11434/api/tags")
    models_data = response.json() if response.status_code == 200 else {"models": []}
```

## üìä **–î–û–°–¢–£–ü–ù–´–ï –ú–ï–¢–†–ò–ö–ò –î–õ–Ø –î–ê–®–ë–û–ê–†–î–ê:**

### **üîß Ollama Status Dashboard:**
1. **–ö–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:** –ó–µ–ª–µ–Ω—ã–π/–∫—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–¥–æ—Ä–æ–≤—å—è
2. **–ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤:** CPU –∏ –ø–∞–º—è—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
3. **–ö–∞—Ä—Ç–æ—á–∫–∞ –º–æ–¥–µ–ª–µ–π:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
4. **–ì—Ä–∞—Ñ–∏–∫ uptime:** –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞
5. **–ì—Ä–∞—Ñ–∏–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:** –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### **üìà Ollama Performance Dashboard:**
1. **–ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
2. **–ö–∞—Ä—Ç–æ—á–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞:** –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
3. **–ö–∞—Ä—Ç–æ—á–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏:** –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** –¢–æ–∫–µ–Ω—ã –≤ —Å–µ–∫—É–Ω–¥—É
5. **–ì—Ä–∞—Ñ–∏–∫ –æ—à–∏–±–æ–∫:** –ü—Ä–æ—Ü–µ–Ω—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤

### **üîç Normcontrol Analytics Dashboard:**
1. **–ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
2. **–ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è:** –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
3. **–ö–∞—Ä—Ç–æ—á–∫–∞ –Ω–∞—Ö–æ–¥–æ–∫:** –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç
4. **–ì—Ä–∞—Ñ–∏–∫ –Ω–∞—Ö–æ–¥–æ–∫:** –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ/–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è/–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
5. **–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üé® **–°–¢–†–£–ö–¢–£–†–ê –î–ê–®–ë–û–ê–†–î–ê:**

### **üì± –ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å:**

#### **–í–µ—Ä—Ö–Ω—è—è —Å—Ç—Ä–æ–∫–∞ - –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤:**
```
[üü¢ Ollama] [üü¢ Document Parser] [üü¢ RAG Service] [üü° Gateway]
```

#### **–°–µ–∫—Ü–∏—è 1 - Ollama Status:**
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 1:** –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ (üü¢/üî¥)
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (CPU: 0%, RAM: 0 GB / 8 GB)
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 3:** –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ (3 –º–æ–¥–µ–ª–∏)
- **–ì—Ä–∞—Ñ–∏–∫ 1:** –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ LLM (81.3 —Å–µ–∫—É–Ω–¥—ã)
- **–ì—Ä–∞—Ñ–∏–∫ 2:** –ó–∞–ø—Ä–æ—Å—ã –∫ LLM (3 –∑–∞ —á–∞—Å)

#### **–°–µ–∫—Ü–∏—è 2 - –ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å:**
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 1:** –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (3)
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 2:** –î–æ–∫—É–º–µ–Ω—Ç—ã –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ (3 pending, 0 completed)
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 3:** –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (0.0%)
- **–ì—Ä–∞—Ñ–∏–∫ 1:** –ù–∞—Ö–æ–¥–∫–∏ –ø–æ —Ç–∏–ø–∞–º (370 –≤—Å–µ–≥–æ: 22 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö, 346 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π, 2 –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö)
- **–ì—Ä–∞—Ñ–∏–∫ 2:** –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (1355.1 –º–∏–Ω—É—Ç)

#### **–°–µ–∫—Ü–∏—è 3 - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 1:** –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (1355.1 –º–∏–Ω—É—Ç)
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 2:** –¢–æ–∫–µ–Ω—ã –≤ —Å–µ–∫—É–Ω–¥—É (45.2)
- **–ö–∞—Ä—Ç–æ—á–∫–∞ 3:** –ü—Ä–æ—Ü–µ–Ω—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤ (100.0%)
- **–ì—Ä–∞—Ñ–∏–∫ 1:** –î–µ—Ç–∞–ª—å–Ω—ã–π —Ç—Ä–µ–π—Å–ª–æ–≥ –≤—Ä–µ–º–µ–Ω–∏
- **–ì—Ä–∞—Ñ–∏–∫ 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

## üéØ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–û–ì–û –†–ï–®–ï–ù–ò–Ø:**

### **1. –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è:**
- ‚úÖ –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î –∏ API

### **2. –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –°—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å LLM
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### **3. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞:**
- ‚úÖ –¢—Ä–µ–Ω–¥—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üìä **–°—Ç–∞—Ç—É—Å:**
**‚úÖ API ENDPOINTS –†–ï–ê–õ–ò–ó–û–í–ê–ù–´ - –ì–û–¢–û–í–´ –ö –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –° GRAFANA**

### **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Prometheus –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫**
2. **–°–æ–∑–¥–∞—Ç—å Grafana –¥–∞—à–±–æ–∞—Ä–¥**
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
4. **–î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**

### **–î–æ—Å—Ç—É–ø–Ω—ã–µ API endpoints:**
- ‚úÖ `GET /api/ollama/status` - —Å—Ç–∞—Ç—É—Å Ollama
- ‚úÖ `GET /api/ollama/performance` - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å Ollama
- ‚úÖ `GET /api/normcontrol/analytics` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è
- ‚úÖ `GET /api/metrics` - –æ–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã

---

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 25.08.2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
