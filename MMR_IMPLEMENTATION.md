# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è MMR (Maximal Marginal Relevance) –¥–ª—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω MMR (Maximal Marginal Relevance) –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –ù–¢–î. MMR –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **MMRService** - –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. **MMRResult** - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ MMR
3. **–ê–ª–≥–æ—Ä–∏—Ç–º MMR** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Maximal Marginal Relevance
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≥–∏–±—Ä–∏–¥–Ω—ã–º –ø–æ–∏—Å–∫–æ–º** - –ë–µ—Å—à–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

```
–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ ‚Üí BGE –†–µ—Ä–∞–Ω–∫–µ—Ä ‚Üí MMR –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

## –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 1. MMRService

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MMR –∞–ª–≥–æ—Ä–∏—Ç–º–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `lambda_param = 0.7` - –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º
- `similarity_threshold = 0.8` - –ø–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–§–æ—Ä–º—É–ª–∞ MMR**:
```
MMR = Œª * Relevance(d) - (1-Œª) * max(Similarity(d, di)) for di in S
```

–ì–¥–µ:
- `Œª` (lambda) - –ø–∞—Ä–∞–º–µ—Ç—Ä –±–∞–ª–∞–Ω—Å–∞ (0.0-1.0)
- `Relevance(d)` - —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∫ –∑–∞–ø—Ä–æ—Å—É
- `Similarity(d, di)` - —Å—Ö–æ–¥—Å—Ç–≤–æ —Å —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

### 2. –ê–ª–≥–æ—Ä–∏—Ç–º MMR

**–®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –í—ã–±–∏—Ä–∞–µ–º —Å–∞–º—ã–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
2. **–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä**: –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:
   - –í—ã—á–∏—Å–ª—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ —Å —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏
   - –í—ã—á–∏—Å–ª—è–µ–º MMR —Å–∫–æ—Ä
   - –í—ã–±–∏—Ä–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º MMR —Å–∫–æ—Ä-–æ–º
3. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ**: –ü–æ–≤—Ç–æ—Ä—è–µ–º –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ë–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ

### 3. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ö–æ–¥—Å—Ç–≤–∞

**–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**:

1. **–¢–æ—á–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã** (similarity = 1.0):
   - –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ ID
   
2. **–î—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É –∏ —á–∞–Ω–∫—É** (similarity = 0.9):
   - –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ document_id –∏ chunk_id
   
3. **–î—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É** (similarity = 0.7):
   - –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ document_id
   
4. **–î—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∫–æ–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞** (similarity = 0.6):
   - –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ code (–ì–û–°–¢, –°–ü, –°–ù–∏–ü –∏ —Ç.–¥.)
   
5. **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ** (similarity = 0.0-1.0):
   - –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ TF –≤–µ–∫—Ç–æ—Ä–æ–≤
   - –£—á–µ—Ç –æ–±—â–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤

### 4. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Ç–æ–ø-—Å–ª–æ–≤
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ TF (Term Frequency)

**–°—Ç–æ–ø-—Å–ª–æ–≤–∞**:
```python
stop_words = {
    '–∏', '–≤', '–Ω–∞', '—Å', '–ø–æ', '–¥–ª—è', '–æ—Ç', '–¥–æ', '–∏–∑', '–∫', '–æ', '—É', '–∑–∞', '–ø—Ä–∏', '–±–µ–∑', 
    '—á–µ—Ä–µ–∑', '–Ω–∞–¥', '–ø–æ–¥', '–º–µ–∂–¥—É', '—Å—Ä–µ–¥–∏', '–≤–æ–∫—Ä—É–≥', '–æ–∫–æ–ª–æ', '–±–ª–∏–∑', '–¥–∞–ª–µ–∫–æ', '–∑–¥–µ—Å—å', 
    '—Ç–∞–º', '–≥–¥–µ', '–∫–æ–≥–¥–∞', '–∫–∞–∫', '—á—Ç–æ', '–∫—Ç–æ', '–∫–æ—Ç–æ—Ä—ã–π', '—ç—Ç–æ', '—Ç–æ—Ç', '—ç—Ç–æ—Ç', '—Ç–∞–∫–æ–π', 
    '–∫–∞–∫–æ–π', '–≤–µ—Å—å', '–≤—Å–µ', '–≤—Å—è', '–≤—Å—ë', '–∫–∞–∂–¥—ã–π', '–ª—é–±–æ–π', '–¥—Ä—É–≥–æ–π', '–∏–Ω–æ–π', '—Å–∞–º', 
    '—Å–∞–º–∞', '—Å–∞–º–æ', '—Å–∞–º–∏', '—Å–µ–±—è', '—Å–µ–±–µ', '—Å–æ–±–æ–π', '–º–æ–π', '–º–æ—è', '–º–æ—ë', '–º–æ–∏', '—Ç–≤–æ–π', 
    '—Ç–≤–æ—è', '—Ç–≤–æ—ë', '—Ç–≤–æ–∏', '–µ–≥–æ', '–µ—ë', '–∏—Ö', '–Ω–∞—à', '–Ω–∞—à–∞', '–Ω–∞—à–µ', '–Ω–∞—à–∏', '–≤–∞—à', 
    '–≤–∞—à–∞', '–≤–∞—à–µ', '–≤–∞—à–∏', '–∏–ª–∏', '–Ω–æ', '–∞', '–¥–∞', '–Ω–µ—Ç', '–Ω–µ', '–Ω–∏', '–∂–µ', '–ª–∏', '–±—ã', 
    '–±', '—Ç–æ', '–∂–µ', '–ª–∏', '–±—ã', '–±', '—Ç–æ', '–∂–µ', '–ª–∏', '–±—ã', '–±'
}
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É

### Backend (RAG Service)

**–§–∞–π–ª—ã**:
- `rag_service/services/mmr_service.py` - –û—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- `rag_service/services/ollama_rag_service.py` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ RAG —Å–µ—Ä–≤–∏—Å

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ hybrid_search**:
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MMR —Å–µ—Ä–≤–∏—Å–∞
self.mmr_service = MMRService(
    lambda_param=0.7,  # –ë–∞–ª–∞–Ω—Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
    similarity_threshold=0.8
)

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ MMR –ø–æ—Å–ª–µ —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–∞
if use_mmr and not fast_mode and len(final_results) > k:
    mmr_results = self.mmr_service.diversify_results(
        results=final_results,
        k=k,
        query=query,
        use_semantic_similarity=True
    )
```

### Frontend

**–§–∞–π–ª—ã**:
- `frontend/src/components/NTDConsultation.js` - UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–ù–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã**:
- –ö–∞—Ä—Ç–æ—á–∫–∞ "MMR –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è" —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ lambda –∏ –ø–æ—Ä–æ–≥–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏
- –°—Ç–∞—Ç—É—Å –≤–∫–ª—é—á–µ–Ω–∏—è MMR

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```python
# MMR –°–µ—Ä–≤–∏—Å
lambda_param = 0.7        # –ë–∞–ª–∞–Ω—Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
similarity_threshold = 0.8 # –ü–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

# –ü–æ–∏—Å–∫
use_mmr = True           # –í–∫–ª—é—á–µ–Ω–∏–µ MMR –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
use_semantic_similarity = True  # –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–ª–∞–Ω—Å–∞

- **lambda = 0.0** - –¢–æ–ª—å–∫–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å)
- **lambda = 0.5** - –†–∞–≤–Ω—ã–π –±–∞–ª–∞–Ω—Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
- **lambda = 1.0** - –¢–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ)
- **lambda = 0.7** - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–±–æ–ª—å—à–µ –≤–µ—Å–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏)

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏

- **–í—Ä–µ–º—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**: ~100-300ms –¥–ª—è 50 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–ü–∞–º—è—Ç—å**: ~10-20MB –¥–ª—è MMR –∏–Ω–¥–µ–∫—Å–æ–≤
- **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ**: –£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 40-60% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–æ—Å—Ç–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- **–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ 90-95% —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**: –ë—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—á–µ–≤–∏–¥–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ TF –≤–µ–∫—Ç–æ—Ä–æ–≤**: –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞**: –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫–∞—á–µ—Å—Ç–≤–æ–º –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é
4. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```
üîÑ [MMR] Diversifying 50 results ‚Üí 8 with lambda=0.7
üîÑ [MMR] Computing similarity between documents
‚úÖ [MMR] Diversification completed: 8 results
üèÜ [MMR] Top 1: mmr_score=0.856, relevance=0.234, diversity=0.123, title='...'
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–î–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ API endpoint `/hybrid_search_stats`:
- –ü–∞—Ä–∞–º–µ—Ç—Ä lambda
- –ü–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
- –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ**: –ò–∑–±–µ–≥–∞–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã—Å–æ–∫–æ–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
- **–ë–∞–ª–∞–Ω—Å**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

### 2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å—Ö–æ–¥—Å—Ç–≤–∞
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### 3. –ì–∏–±–∫–æ—Å—Ç—å
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è lambda –∏ –ø–æ—Ä–æ–≥–æ–≤
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ë–µ—Å—à–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π
- **Fallback**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
mmr_service = MMRService(
    lambda_param=0.7,
    similarity_threshold=0.8
)

# –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
diversified_results = mmr_service.diversify_results(
    results=search_results,  # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞
    k=8,                     # –§–∏–Ω–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    query="—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ–∂–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
    use_semantic_similarity=True
)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
stats = mmr_service.get_diversity_stats(diversified_results)
```

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ù–¢–î –æ—Ç –ò–ò"
2. –ù–∞–∂–º–∏—Ç–µ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∏—Å–∫–∞" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ MMR
3. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MMR
4. –ü–æ–ª—É—á–∏—Ç–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π

### –î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è MMR:
- –í–æ–∑–º–æ–∂–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ
- –ü—Ä–æ—Å—Ç–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏

### –ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è MMR:
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- –ë–∞–ª–∞–Ω—Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
- –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π MMR –∞–ª–≥–æ—Ä–∏—Ç–º –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –ù–¢–î, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è**:
- ‚úÖ MMR –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–∞–ª–∞–Ω—Å–∞
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≥–∏–±—Ä–∏–¥–Ω—ã–º –ø–æ–∏—Å–∫–æ–º
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
