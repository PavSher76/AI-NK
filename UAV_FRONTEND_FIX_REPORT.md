# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Ä–∞—Å—á–µ—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ—Ç –ë–ü–õ–ê

## –ü—Ä–æ–±–ª–µ–º—ã
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª –æ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Ä–∞—Å—á–µ—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ—Ç –ë–ü–õ–ê:

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ —Ä–∞—Å—á–µ—Ç–æ–≤**: "shock_wave" –∏ "impact_penetration" –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
2. **–ù–µ–ø–æ–ª–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤–∑—Ä—ã–≤—á–∞—Ç—ã—Ö –≤–µ—â–µ—Å—Ç–≤**: –¢–æ–ª—å–∫–æ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
3. **–ù–µ–ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã**: –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ –ë–ü–õ–ê –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
4. **–û—à–∏–±–∫–∞ 504 Gateway Time-out**: –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–∞—Å—á–µ—Ç–æ–≤ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞
5. **–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON**: "Unexpected token '<', "<html>..." is not valid JSON"

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å API –∑–∞–ø—Ä–æ—Å–∞–º–∏
**–§–∞–π–ª**: `frontend/src/pages/UAVProtectionCalculationsPage.js`

**–ü—Ä–æ–±–ª–µ–º–∞**: –§—É–Ω–∫—Ü–∏—è `handleNewCalculation` –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- `type: calculationType` –≤–º–µ—Å—Ç–æ `type: 'uav_protection'`
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `category`
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `parameters`

### 2. –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Ä–∞—Å—á–µ—Ç–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: –§—É–Ω–∫—Ü–∏–∏ `handleViewCalculation` –∏ `handleDownloadCalculation` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ endpoints:
- `/calculations/${calculation.type}/execute` –≤–º–µ—Å—Ç–æ `/calculations/${calculation.id}/execute`

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–≤–æ–¥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫

#### –¢–∏–ø—ã —Ä–∞—Å—á–µ—Ç–æ–≤:
```javascript
// –ë—ã–ª–æ:
{ id: 'shock_wave', name: '–†–∞—Å—á—ë—Ç –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è —É–¥–∞—Ä–Ω–æ–π –≤–æ–ª–Ω—ã' }
{ id: 'impact_penetration', name: '–†–∞—Å—á—ë—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è –ë–ü–õ–ê –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é' }

// –°—Ç–∞–ª–æ:
{ id: 'shock_wave', name: '–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞—Ä–Ω–æ–π –≤–æ–ª–Ω—ã' }
{ id: 'impact_penetration', name: '–ü–æ–ø–∞–¥–∞–Ω–∏–µ –ë–ü–õ–ê –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é' }
```

#### –í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞ —Å –ø–æ–ª–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏:
```javascript
// –ë—ã–ª–æ:
{ value: 'TNT', label: '–¢–ù–¢' }
{ value: 'RDX', label: '–†–î–•' }

// –°—Ç–∞–ª–æ:
{ value: 'TNT', label: '–¢–ù–¢ (—Ç—Ä–∏–Ω–∏—Ç—Ä–æ—Ç–æ–ª—É–æ–ª)' }
{ value: 'RDX', label: '–†–î–• (–≥–µ–∫—Å–æ–≥–µ–Ω)' }
{ value: 'PETN', label: '–ü–≠–¢–ù (–ø–µ–Ω—Ç–∞—ç—Ä–∏—Ç—Ä–∏—Ç—Ç–µ—Ç—Ä–∞–Ω–∏—Ç—Ä–∞—Ç)' }
{ value: 'HMX', label: '–ì–ú–• (–æ–∫—Ç–æ–≥–µ–Ω)' }
```

#### –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (—É–∂–µ –±—ã–ª–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º):
```javascript
{ value: 'concrete', label: '–ë–µ—Ç–æ–Ω' }
{ value: 'steel', label: '–°—Ç–∞–ª—å' }
{ value: 'brick', label: '–ö–∏—Ä–ø–∏—á' }
{ value: 'wood', label: '–î–µ—Ä–µ–≤–æ' }
```

#### –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ë–ü–õ–ê (—É–∂–µ –±—ã–ª–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º):
```javascript
{ value: 'aluminum', label: '–ê–ª—é–º–∏–Ω–∏–π' }
{ value: 'carbon_fiber', label: '–£–≥–ª–µ—Ä–æ–¥–Ω–æ–µ –≤–æ–ª–æ–∫–Ω–æ' }
{ value: 'steel', label: '–°—Ç–∞–ª—å' }
{ value: 'plastic', label: '–ü–ª–∞—Å—Ç–∏–∫' }
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤

#### –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤:
```javascript
// –ë—ã–ª–æ:
body: JSON.stringify({
  type: calculationType,
  name: `–†–∞—Å—á–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –ë–ü–õ–ê - ${new Date().toLocaleString()}`,
  description: `–ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç ${calculationType}`,
  parameters: {}
})

// –°—Ç–∞–ª–æ:
body: JSON.stringify({
  type: 'uav_protection',
  category: calculationType,
  name: `–†–∞—Å—á–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –ë–ü–õ–ê - ${calculationType === 'shock_wave' ? '–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞—Ä–Ω–æ–π –≤–æ–ª–Ω—ã' : '–ü–æ–ø–∞–¥–∞–Ω–∏–µ –ë–ü–õ–ê –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é'} - ${new Date().toLocaleString()}`,
  description: `–ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç ${calculationType === 'shock_wave' ? '–≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è —É–¥–∞—Ä–Ω–æ–π –≤–æ–ª–Ω—ã' : '–ø–æ–ø–∞–¥–∞–Ω–∏—è –ë–ü–õ–ê –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é'}`,
  parameters: {
    calculation_subtype: calculationType
  }
})
```

#### –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:
```javascript
// –ë—ã–ª–æ:
const response = await fetch(`${API_BASE}/calculations/${calculation.type}/execute`, {
  body: JSON.stringify({ calculation_type: calculation.type, parameters: calculation.parameters })
});

// –°—Ç–∞–ª–æ:
const response = await fetch(`${API_BASE}/calculations/${calculation.id}/execute`, {
  body: JSON.stringify({ parameters: calculation.parameters })
});
```

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```javascript
if (!response.ok) {
  const errorText = await response.text();
  console.error('üîç [DEBUG] Response error:', errorText);
  let errorData;
  try {
    errorData = JSON.parse(errorText);
  } catch (e) {
    throw new Error(`HTTP error! status: ${response.status}, response: ${errorText}`);
  }
  throw new Error(errorData.detail || `HTTP error! status: ${response.status}`);
}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤

```javascript
<select>
  <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
  <option value="shock_wave">–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞—Ä–Ω–æ–π –≤–æ–ª–Ω—ã</option>
  <option value="impact_penetration">–ü–æ–ø–∞–¥–∞–Ω–∏–µ –ë–ü–õ–ê –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é</option>
</select>
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ —á–µ—Ä–µ–∑ API
```bash
curl -X POST http://localhost:8004/calculations \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è —É–¥–∞—Ä–Ω–æ–π –≤–æ–ª–Ω—ã",
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è —É–¥–∞—Ä–Ω–æ–π –≤–æ–ª–Ω—ã –æ—Ç –ë–ü–õ–ê",
    "type": "uav_protection",
    "category": "shock_wave",
    "parameters": {
      "calculation_subtype": "shock_wave",
      "uav_mass": 5.0,
      "distance": 10.0,
      "explosive_type": "TNT",
      "explosion_height": 5.0,
      "structure_material": "concrete",
      "structure_thickness": 200.0
    }
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω —Ä–∞—Å—á–µ—Ç —Å ID 15

### –¢–µ—Å—Ç 2: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –¢–∏–ø—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- ‚úÖ –í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–ª–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- ‚úÖ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ —Ä—É—Å—Å–∫–∏–π
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å —Ä—É—Å—Å–∫–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º —Ä–∞—Å—á–µ—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ—Ç –ë–ü–õ–ê —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:

1. ‚úÖ **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞** - –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫
2. ‚úÖ **–ü–æ–ª–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤–∑—Ä—ã–≤—á–∞—Ç—ã—Ö –≤–µ—â–µ—Å—Ç–≤** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä
3. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤
4. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ endpoints –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
5. ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- –ü–æ–ª–Ω–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã API –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –≤–∑—Ä—ã–≤—á–∞—Ç—ã—Ö –≤–µ—â–µ—Å—Ç–≤
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### –°—Ç–∞—Ç—É—Å: ‚úÖ –í–°–ï –ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞—Å—á–µ—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ—Ç –ë–ü–õ–ê —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å API —Å–µ—Ä–≤–∏—Å–∞ —Ä–∞—Å—á–µ—Ç–æ–≤.
