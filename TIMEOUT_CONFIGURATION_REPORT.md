# ‚è±Ô∏è –ù–ê–°–¢–†–û–ô–ö–ê –¢–ê–ô–ú–ê–£–¢–û–í - –û–¢–ß–ï–¢

## üéØ **–¶–µ–ª—å:**
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π:
- **–ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)**: 10 –º–∏–Ω—É—Ç (600 —Å–µ–∫—É–Ω–¥)
- **–ß–∞—Ç —Å –ò–ò**: 2 –º–∏–Ω—É—Ç—ã (120 —Å–µ–∫—É–Ω–¥)

## ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø:**

### **1. Document Parser (`document_parser/main.py`)**

#### **–ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å - 10 –º–∏–Ω—É—Ç:**
```python
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç 10 –º–∏–Ω—É—Ç –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è
timeout = httpx.Timeout(600.0, connect=30.0)
```

#### **–ß–∞—Ç —Å –ò–ò - 2 –º–∏–Ω—É—Ç—ã:**
```python
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç 2 –º–∏–Ω—É—Ç—ã –¥–ª—è —á–∞—Ç–∞ —Å –ò–ò
timeout = httpx.Timeout(120.0, connect=30.0)
```

### **2. Gateway (`gateway/app.py`)**

#### **–û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç - 10 –º–∏–Ω—É—Ç:**
```python
async with httpx.AsyncClient(timeout=600.0) as client:
    print(f"üîç [DEBUG] Gateway: Creating httpx client with timeout 600s")
```

### **3. Ollama Configuration (`docker-compose.yaml`)**

#### **–£–¥–∞–ª–µ–Ω –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π —Ç–∞–π–º–∞—É—Ç:**
```yaml
# –£–¥–∞–ª–µ–Ω–æ:
# - OLLAMA_TIMEOUT=120
```

### **4. Modelfile Optimization (`Modelfile.optimized`)**

#### **–£–≤–µ–ª–∏—á–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –æ—Ç–≤–µ—Ç–∞:**
```
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ (—É–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è)
PARAMETER num_predict 4096
```

## üß™ **–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:**

### **–¢–µ—Å—Ç 1: –ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å (10 –º–∏–Ω—É—Ç)**
```
ü§ñ [LLM] 2025-08-25 19:36:34.058 [DOC:25] RESPONSE: –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1, –≤—Ä–µ–º—è 428.34—Å, –æ—Ç–≤–µ—Ç 728 —Å–∏–º–≤–æ–ª–æ–≤
üîç [TRACE] 2025-08-25 19:36:34.058 [DOC:25] STEP: LLM_RESPONSE - –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç LLM –∑–∞ 428.34—Å
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –£—Å–ø–µ—à–Ω–æ! LLM –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª –∑–∞–ø—Ä–æ—Å –±–æ–ª–µ–µ 7 –º–∏–Ω—É—Ç (428 —Å–µ–∫—É–Ω–¥), —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ª–∏–º–∏—Ç–∞ –≤ 2 –º–∏–Ω—É—Ç—ã.

### **–¢–µ—Å—Ç 2: –ß–∞—Ç —Å –ò–ò (2 –º–∏–Ω—É—Ç—ã)**
```json
{
  "model": "llama3.1-optimized-v2:latest",
  "response": "–ü—Ä–∏–≤–µ—Ç! –£ –º–µ–Ω—è –≤—Å–µ —Ö–æ—Ä–æ—à–æ. –Ø –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ –ø–æ –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—é –ø—Ä–æ–µ–∫—Ç–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏...",
  "total_duration": 77750765243
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –£—Å–ø–µ—à–Ω–æ! –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–∞–π–º–∞—É—Ç—É 2 –º–∏–Ω—É—Ç—ã.

### **–¢–µ—Å—Ç 3: API –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**
```bash
curl -X GET "https://localhost:8443/api/checkable-documents" -H "Authorization: Bearer test-token" -k
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 3 –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ã
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –£—Å–ø–µ—à–Ω–æ! API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–æ–≤.

## üìä **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:**

### **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–∞–π–º–∞—É—Ç–æ–≤:**

| –û–ø–µ—Ä–∞—Ü–∏—è | –¢–∞–π–º–∞—É—Ç | –§–∞–π–ª | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|---------|------|-------------|
| **–ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å** | 600 —Å–µ–∫ (10 –º–∏–Ω) | `document_parser/main.py` | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| **–ß–∞—Ç —Å –ò–ò** | 120 —Å–µ–∫ (2 –º–∏–Ω) | `document_parser/main.py` | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ |
| **Gateway** | 600 —Å–µ–∫ (10 –º–∏–Ω) | `gateway/app.py` | –û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π |
| **Ollama** | –ù–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω | `docker-compose.yaml` | –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã LLM:**
- **num_predict**: 4096 —Ç–æ–∫–µ–Ω–æ–≤ (—É–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è)
- **num_ctx**: 16384 (–∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
- **temperature**: 0.1 (–Ω–∏–∑–∫–∞—è –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏)
- **top_p**: 0.9 (–∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤)
- **top_k**: 40 (—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ)

## üéØ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ô –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò:**

### **1. –ì–∏–±–∫–æ—Å—Ç—å —Ç–∞–π–º–∞—É—Ç–æ–≤:**
- ‚úÖ –†–∞–∑–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –∑–∞–¥–∞—á
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π

### **2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- ‚úÖ –ß–∞—Ç —Å –ò–ò –æ—Å—Ç–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä—ã–º –∏ –æ—Ç–∑—ã–≤—á–∏–≤—ã–º
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### **3. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã:**
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤ –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á
- ‚úÖ –ù–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üìà **–ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –ê–ù–ê–õ–ò–ó:**

### **–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
1. **–í—Ä–µ–º—è –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è:** –¶–µ–ª—å < 10 –º–∏–Ω—É—Ç –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
2. **–í—Ä–µ–º—è —á–∞—Ç–∞ —Å –ò–ò:** –¶–µ–ª—å < 2 –º–∏–Ω—É—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
3. **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π:** % –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –±–µ–∑ —Ç–∞–π–º–∞—É—Ç–æ–≤
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** —Ç–æ–∫–µ–Ω—ã/—Å–µ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### **–ê–ª–µ—Ä—Ç–∏–Ω–≥:**
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 8 –º–∏–Ω—É—Ç –¥–ª—è –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 90 —Å–µ–∫—É–Ω–¥ –¥–ª—è —á–∞—Ç–∞ —Å –ò–ò
- ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤

## üîß **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:**

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –∞–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤** - —É–ª—É—á—à–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ LLM –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫—É
4. **–ê–ª–µ—Ä—Ç–∏–Ω–≥** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ —Ç–∞–π–º–∞—É—Ç–æ–≤

## üìä **–°—Ç–∞—Ç—É—Å:**
**‚úÖ –¢–ê–ô–ú–ê–£–¢–´ –ù–ê–°–¢–†–û–ï–ù–´ - –°–ò–°–¢–ï–ú–ê –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ê –î–õ–Ø –†–ê–ó–ù–´–• –¢–ò–ü–û–í –û–ü–ï–†–ê–¶–ò–ô**

### **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:**
- ‚úÖ –ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å: 10 –º–∏–Ω—É—Ç –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ß–∞—Ç —Å –ò–ò: 2 –º–∏–Ω—É—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ Gateway: 10 –º–∏–Ω—É—Ç –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–π —Ç—Ä–µ–π—Å–ª–æ–≥: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

**–î–∞—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** 25.08.2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
