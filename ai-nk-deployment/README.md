# AI-НК - Пакет развертывания

## Описание

Этот пакет содержит все необходимые файлы и скрипты для развертывания системы AI-НК на новой платформе.

## Структура пакета

```
ai-nk-deployment/
├── scripts/                    # Скрипты установки и управления
│   ├── install.sh             # Основной скрипт установки
│   ├── quick-deploy.sh        # Быстрое развертывание для разработки
│   └── create-package.sh      # Создание пакета развертывания
├── configs/                    # Конфигурационные шаблоны
│   ├── .env.template          # Шаблон переменных окружения
│   ├── nginx.conf.template    # Шаблон конфигурации Nginx
│   └── docker-compose.prod.template  # Шаблон Docker Compose для продакшна
├── docs/                       # Документация
│   ├── INSTALLATION.md        # Руководство по установке
│   └── CONFIGURATION.md       # Руководство по настройке
├── examples/                   # Примеры конфигураций
│   ├── production.env         # Пример конфигурации для продакшна
│   └── auto-deploy.sh         # Пример автоматического развертывания
└── packages/                   # Готовые пакеты для развертывания
    ├── ai-nk-deployment-*.tar.gz
    ├── ai-nk-deployment-*.zip
    └── README.md
```

## Быстрый старт

### 1. Создание пакета развертывания

```bash
# Создание полного пакета
./build-deployment.sh

# Пакет будет создан в папке packages/
```

### 2. Развертывание на новой платформе

```bash
# Распаковка пакета
tar -xzf ai-nk-deployment-*.tar.gz
cd ai-nk-deployment-*

# Установка
./install.sh

# Запуск
cd ai-nk
./start.sh
```

### 3. Быстрое развертывание для разработки

```bash
# Быстрое развертывание
./install.sh dev

# Или напрямую
./scripts/quick-deploy.sh
```

## Скрипты установки

### install.sh
Основной скрипт установки для продакшн развертывания:
- Проверка системных требований
- Установка зависимостей
- Создание структуры проекта
- Настройка конфигурации
- Генерация SSL сертификатов
- Создание скриптов управления

### quick-deploy.sh
Быстрое развертывание для разработки:
- Минимальная конфигурация
- Быстрый запуск сервисов
- Отключение SSL для разработки
- Упрощенная настройка

### create-package.sh
Создание готового пакета для развертывания:
- Копирование исходного кода
- Создание документации
- Генерация конфигураций
- Создание архива

## Конфигурационные шаблоны

### .env.template
Шаблон переменных окружения с настройками по умолчанию:
- Настройки базы данных
- Конфигурация Redis
- Параметры JWT
- Настройки SSL
- Конфигурация сервисов

### nginx.conf.template
Шаблон конфигурации Nginx:
- Настройка проксирования
- SSL конфигурация
- Безопасность
- Оптимизация производительности

### docker-compose.prod.template
Шаблон Docker Compose для продакшна:
- Настройки ресурсов
- Health checks
- Restart policies
- Volumes
- Networks

## Примеры

### production.env
Пример конфигурации для продакшн развертывания:
- Безопасные пароли
- Настройки домена
- SSL конфигурация
- Мониторинг

### auto-deploy.sh
Пример автоматического развертывания:
- Обновление системы
- Установка зависимостей
- Настройка пользователей
- Автоматическая конфигурация

## Документация

### INSTALLATION.md
Подробное руководство по установке:
- Системные требования
- Предварительная подготовка
- Пошаговая установка
- Проверка установки
- Устранение неполадок

### CONFIGURATION.md
Руководство по настройке:
- Переменные окружения
- Настройка базы данных
- Конфигурация аутентификации
- Настройка SSL
- Оптимизация производительности

## Системные требования

### Минимальные требования
- **ОС**: Linux (Ubuntu 20.04+) или macOS (10.15+)
- **RAM**: 8GB
- **Диск**: 50GB свободного места
- **CPU**: 4 ядра
- **Docker**: 20.10+
- **Docker Compose**: 2.0+

### Рекомендуемые требования
- **ОС**: Linux (Ubuntu 22.04+) или macOS (12+)
- **RAM**: 16GB+
- **Диск**: 100GB+ SSD
- **CPU**: 8+ ядер

## Управление системой

После установки доступны следующие скрипты управления:

```bash
# Основные команды
./start.sh          # Запуск системы
./stop.sh           # Остановка системы
./restart.sh        # Перезапуск системы
./update.sh         # Обновление системы

# Резервное копирование
./backup.sh         # Создание резервной копии
./restore.sh <архив> # Восстановление из резервной копии

# Мониторинг
./monitor.sh        # Мониторинг системы
./cleanup.sh        # Очистка системы
```

## Безопасность

### Рекомендации для продакшна

1. **Измените все пароли по умолчанию**
2. **Используйте надежные SSL сертификаты**
3. **Настройте файрвол**
4. **Регулярно обновляйте систему**
5. **Мониторьте логи на предмет подозрительной активности**

### Настройка файрвола

```bash
# UFW (Ubuntu)
ufw default deny incoming
ufw default allow outgoing
ufw allow ssh
ufw allow 80/tcp
ufw allow 443/tcp
ufw enable

# iptables
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A INPUT -j DROP
```

## Мониторинг

### Логи
Логи сервисов находятся в папке `logs/`:
- `logs/gateway/` - логи API Gateway
- `logs/calculation-service/` - логи сервиса расчетов
- `logs/rag-service/` - логи RAG сервиса
- `logs/chat-service/` - логи чат сервиса
- `logs/frontend/` - логи фронтенда

### Prometheus и Grafana
- **Prometheus**: http://localhost:9090
- **Grafana**: http://localhost:3001 (admin/admin)

## Резервное копирование

### Автоматическое резервное копирование
Система автоматически создает резервные копии каждый день в 2:00.

### Ручное резервное копирование
```bash
./backup.sh
```

### Восстановление
```bash
./restore.sh backups/20240101_120000.tar.gz
```

## Устранение неполадок

### Проблемы с запуском
1. Проверьте системные требования
2. Убедитесь, что порты свободны
3. Проверьте логи: `./monitor.sh`

### Проблемы с производительностью
1. Увеличьте объем RAM
2. Настройте параметры Docker
3. Оптимизируйте конфигурацию базы данных

### Проблемы с SSL
1. Проверьте сертификаты в папке `ssl/`
2. Убедитесь в правильности прав доступа
3. Перегенерируйте сертификаты при необходимости

## Поддержка

- **Документация**: [docs/](docs/)
- **Поддержка**: support@ai-nk.ru
- **Баг-трекер**: https://github.com/ai-nk/issues
- **Форум**: https://forum.ai-nk.ru

## Лицензия

Проект распространяется под лицензией MIT. См. файл [LICENSE](../LICENSE).

## Авторы

- AI-НК Team
- Контрибьюторы: [CONTRIBUTORS.md](../CONTRIBUTORS.md)

---

**AI-НК** - Система нормоконтроля с использованием искусственного интеллекта
