# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ù–¢–î –æ—Ç –ò–ò"

## üìã –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 28 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏:** 19:55  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  

## üîç –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –°—Ç–∞—Ç—É—Å OLLAMA —á–µ—Ä–µ–∑ VLLM

#### ‚úÖ VLLM Adapter —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **Endpoint:** `http://localhost:8000/v1/models`
- **–°—Ç–∞—Ç—É—Å:** 200 OK
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏:**
  - `llama3.1-optimized-v2:latest`
  - `llama3.1-optimized:latest`
  - `llama3.1:8b`

#### ‚úÖ VLLM Chat Completions —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Endpoint:** `http://localhost:8000/v1/chat/completions`
- **–°—Ç–∞—Ç—É—Å:** 200 OK
- **–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:** `{"model": "llama3.1:8b", "messages": [{"role": "user", "content": "Hello"}], "temperature": 0.7}`
- **–û—Ç–≤–µ—Ç:** `"Hello! How can I assist you today?"`

### 2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ

#### ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–∞
- **Endpoint:** `https://localhost/api/documents/stats`
- **–°—Ç–∞—Ç—É—Å:** 200 OK
- **–î–∞–Ω–Ω—ã–µ:**
  ```json
  {
    "statistics": {
      "total_documents": 9,
      "indexed_documents": 9,
      "indexing_progress_percent": 100.0,
      "total_tokens": 174154,
      "categories": [
        {"category": "gost", "count": 8},
        {"category": "corporate", "count": 1}
      ]
    }
  }
  ```

#### ‚úÖ –°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω
- **Endpoint:** `http://localhost:8003/documents`
- **–°—Ç–∞—Ç—É—Å:** 200 OK
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 9
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:**
  - –ì–û–°–¢ –¥–æ–∫—É–º–µ–Ω—Ç—ã: 8 —à—Ç.
  - –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: 1 —à—Ç.

### 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –ù–¢–î

#### ‚úÖ API –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Endpoint:** `http://localhost:8003/ntd-consultation/chat`
- **–ú–µ—Ç–æ–¥:** POST
- **–°—Ç–∞—Ç—É—Å:** 200 OK

#### ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
- **–ó–∞–ø—Ä–æ—Å:** `{"message": "–ß—Ç–æ —Ç–∞–∫–æ–µ –ï–°–ö–î?", "user_id": "test"}`
- **–û—Ç–≤–µ—Ç:**
  ```json
  {
    "response": "–ï–°–ö–î (–ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏) - —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –Ω–æ—Ä–º—ã –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –∏ –æ–±—Ä–∞—â–µ–Ω–∏—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏. –≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –≤ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –ø–æ–≤—ã—à–µ–Ω–∏—é –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.",
    "sources": [],
    "confidence": 0.8,
    "documents_used": 0
  }
  ```

### 4. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

#### ‚úÖ RAG Service
- **–°—Ç–∞—Ç—É—Å:** Healthy
- **Endpoint:** `http://localhost:8003/health`
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
  - PostgreSQL: ‚úÖ Connected
  - Qdrant: ‚úÖ Connected
  - Embedding Model: BGE-M3

#### ‚úÖ VLLM Service
- **–°—Ç–∞—Ç—É—Å:** Running
- **–ü–æ—Ä—Ç:** 8000
- **–ú–æ–¥–µ–ª–∏:** –î–æ—Å—Ç—É–ø–Ω—ã

#### ‚úÖ Gateway
- **–°—Ç–∞—Ç—É—Å:** Running
- **–ü–æ—Ä—Ç:** 8443
- **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –ù–¢–î

1. **Frontend (NTDConsultation.js)**
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
   - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

2. **Gateway (app.py)**
   - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   - –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Å–µ—Ä–≤–∏—Å–∞–º

3. **RAG Service (main.py)**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å VLLM
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

4. **VLLM Adapter (ollama_adapter.py)**
   - OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Ollama
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ LLM –∑–∞–ø—Ä–æ—Å–æ–≤

5. **Ollama**
   - –õ–æ–∫–∞–ª—å–Ω—ã–µ LLM –º–æ–¥–µ–ª–∏
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è—Ö
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–µ—Ç–æ–¥ `get_consultation` –≤–æ–∑–≤—Ä–∞—â–∞–ª –∫–æ—Ä—É—Ç–∏–Ω—É –≤–º–µ—Å—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- **–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª `OLLAMA_URL` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω URL `http://vllm:8000`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- **–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ `rag-service`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### –î–æ–∫—É–º–µ–Ω—Ç—ã
- **–í—Å–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 9
- **–ü—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ:** 9 (100%)
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤:** 174,154
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:** –ì–û–°–¢ (8), –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ (1)

### –°–µ—Ä–≤–∏—Å—ã
- **RAG Service:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **VLLM Adapter:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **Ollama:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **Gateway:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **Frontend:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–æ–π:** –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø–æ–∏—Å–∫ –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
2. **–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–Ω—É—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å –ø–æ–∏—Å–∫–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π
3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ù–¢–î –æ—Ç –ò–ò" —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

- ‚úÖ VLLM Adapter –¥–æ—Å—Ç—É–ø–µ–Ω –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ 9 –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ API –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ Gateway –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º.
