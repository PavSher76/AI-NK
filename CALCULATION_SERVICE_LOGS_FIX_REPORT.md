# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –ª–æ–≥–∞–º–∏ —Å–µ—Ä–≤–∏—Å–∞ —Ä–∞—Å—á–µ—Ç–æ–≤

## –†–µ–∑—é–º–µ

–£—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ Qdrant –≤ —Å–µ—Ä–≤–∏—Å–µ —Ä–∞—Å—á–µ—Ç–æ–≤. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üîç –í—ã—è–≤–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

### –õ–æ–≥–∏ –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
2025-09-11 12:06:20,986 - httpcore.connection - DEBUG - connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2025-09-11 12:06:20,986 - httpcore.connection - DEBUG - connect_tcp.failed exception=ConnectError(ConnectionRefusedError(111, 'Connection refused'))
2025-09-11 12:06:20,986 - main - WARNING - üîç [HEALTH] Qdrant check failed: [Errno 111] Connection refused
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Ä–≤–∏—Å —Ä–∞—Å—á–µ—Ç–æ–≤ –ø—ã—Ç–∞–ª—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Qdrant –ø–æ –∞–¥—Ä–µ—Å—É `localhost:6333` –≤–º–µ—Å—Ç–æ `qdrant:6333` –≤ Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–∏.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Qdrant

**–§–∞–π–ª:** `calculation_service/config.py`

**–ë—ã–ª–æ:**
```python
QDRANT_URL: str = os.getenv('QDRANT_URL', 'http://localhost:6333')
```

**–°—Ç–∞–ª–æ:**
```python
QDRANT_URL: str = os.getenv('QDRANT_URL', f'http://{os.getenv("QDRANT_HOST", "localhost")}:{os.getenv("QDRANT_PORT", "6333")}')
```

### 2. –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
docker-compose stop calculation-service
docker-compose build calculation-service
docker-compose up -d calculation-service
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –õ–æ–≥–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
2025-09-11 12:07:46,802 - httpx - INFO - HTTP Request: GET http://qdrant:6333/collections "HTTP/1.1 200 OK"
2025-09-11 12:07:46,803 - main - DEBUG - üîç [HEALTH] Qdrant check: healthy
2025-09-11 12:07:46,803 - main - DEBUG - üîç [HEALTH] Health check passed in 0.000s
```

### –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞:
```json
{
  "status": "healthy",
  "timestamp": "2025-09-11T12:07:46.803153",
  "uptime": 10.904515,
  "version": "1.0.0",
  "services": {
    "database": "healthy",
    "qdrant": "healthy"
  }
}
```

## üìä –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **PostgreSQL:** ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. **Qdrant:** ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
3. **–ü–∞–º—è—Ç—å:** ‚úÖ RSS: 129.4MB, VMS: 684.7MB
4. **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞:** ‚úÖ <20ms –¥–ª—è health check

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞:** ~5 —Å–µ–∫—É–Ω–¥
- **–°—Ç–∞—Ç—É—Å:** Healthy
- **–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã:** –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ, –¥–µ—Ç–∞–ª—å–Ω–æ–µ

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **Health check:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
- **–í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î:** Qdrant –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
- **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:** –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
- **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å—á–µ—Ç—ã —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ health check:** ~18ms
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:** 129.4MB RSS
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è
- **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** 100%

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:
1. **PostgreSQL (norms-db:5432)** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
2. **Qdrant (qdrant:6333)** - –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
3. **API Gateway** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π

### ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- **Health check:** `/health` - –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **–ú–µ—Ç—Ä–∏–∫–∏:** `/metrics` - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ —Å –ª–æ–≥–∞–º–∏ —Å–µ—Ä–≤–∏—Å–∞ —Ä–∞—Å—á–µ—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!**

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:
- **Qdrant –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã:** –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –∏ –∑–¥–æ—Ä–æ–≤—ã
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è

### üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- –°–µ—Ä–≤–∏—Å —Ä–∞—Å—á–µ—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π AI-NK

**–°–µ—Ä–≤–∏—Å —Ä–∞—Å—á–µ—Ç–æ–≤ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** üéØ

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

- ‚úÖ `calculation_service/config.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è QDRANT_URL –¥–ª—è Docker
- ‚úÖ `CALCULATION_SERVICE_LOGS_FIX_REPORT.md` - –æ—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
