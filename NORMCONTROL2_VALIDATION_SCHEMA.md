# 🔄 Схема проверок документа "Нормоконтроль-2"

## 📊 Общая схема процесса

```
ЗАГРУЗКА ДОКУМЕНТА
        ↓
    ПРОВЕРКА ФАЙЛА
        ↓
    ИЗВЛЕЧЕНИЕ ДАННЫХ
        ↓
    ПАРАЛЛЕЛЬНЫЕ ПРОВЕРКИ
        ↓
    АГРЕГАЦИЯ РЕЗУЛЬТАТОВ
        ↓
    ФОРМИРОВАНИЕ ОТЧЕТА
```

---

## 🔍 Детальная схема проверок

### 1. ПРОВЕРКА ФАЙЛА
```
Файл загружен
    ↓
┌─────────────────────────────────┐
│ 1.1 Формат файла               │
│ • PDF, DWG, DXF, DOCX, XLSX    │
│ • Валидность структуры         │
│ • Отсутствие повреждений       │
└─────────────────────────────────┘
    ↓
┌─────────────────────────────────┐
│ 1.2 Размер файла               │
│ • Максимум: 50 МБ              │
│ • Минимум: 1 КБ                │
│ • Проверка на пустые файлы      │
└─────────────────────────────────┘
    ↓
┌─────────────────────────────────┐
│ 1.3 Безопасность               │
│ • Проверка MIME-типа           │
│ • Отсутствие вредоносного кода │
│ • Валидация расширения         │
└─────────────────────────────────┘
```

### 2. ИЗВЛЕЧЕНИЕ ДАННЫХ
```
Извлечение текста и метаданных
    ↓
┌─────────────────────────────────┐
│ 2.1 Текстовые данные           │
│ • Основная надпись             │
│ • Спецификации                 │
│ • Обозначения                  │
│ • Размеры и единицы            │
└─────────────────────────────────┘
    ↓
┌─────────────────────────────────┐
│ 2.2 Графические данные         │
│ • Линии и штриховка            │
│ • Шрифты и размеры             │
│ • Масштабы                     │
│ • Форматы листов               │
└─────────────────────────────────┘
```

### 3. ПАРАЛЛЕЛЬНЫЕ ПРОВЕРКИ
```
                    ┌─ ЕСКД ВАЛИДАТОР ─┐
                    │ • Основная надпись│
                    │ • Формат листа   │
                    │ • Масштабы       │
                    │ • Шрифты         │
                    │ • Линии          │
                    └──────────────────┘
                           ↓
                    ┌─ СПДС ВАЛИДАТОР ─┐
                    │ • Спецификации   │
                    │ • Обозначения    │
                    │ • Единицы измерения│
                    │ • Форматы        │
                    └──────────────────┘
                           ↓
                    ┌─ ТЕХНИЧЕСКИЕ ────┐
                    │ • Размеры        │
                    │ • Допуски        │
                    │ • Разрезы        │
                    │ • Условные обозначения│
                    └──────────────────┘
                           ↓
                    ┌─ КАЧЕСТВО ───────┐
                    │ • Четкость       │
                    │ • Цвета          │
                    │ • Масштабирование│
                    │ • Читаемость     │
                    └──────────────────┘
```

### 4. СИСТЕМА ОЦЕНКИ
```
Результаты проверок
    ↓
┌─────────────────────────────────┐
│ 4.1 Классификация ошибок       │
│ • Критические (блокирующие)    │
│ • Серьезные (требуют исправления)│
│ • Предупреждения (рекомендации)│
└─────────────────────────────────┘
    ↓
┌─────────────────────────────────┐
│ 4.2 Расчет баллов              │
│ • Основная надпись: 25%        │
│ • Формат и масштаб: 20%        │
│ • Шрифты и линии: 15%          │
│ • Обозначения: 15%             │
│ • Единицы измерения: 10%       │
│ • Качество изображения: 10%    │
│ • Технические требования: 5%   │
└─────────────────────────────────┘
    ↓
┌─────────────────────────────────┐
│ 4.3 Итоговая оценка            │
│ • 90-100%: Полное соответствие │
│ • 80-89%: С незначительными    │
│ • 70-79%: С замечаниями        │
│ • 60-69%: Частичное            │
│ • 0-59%: Несоответствие        │
└─────────────────────────────────┘
```

---

## ⚡ Быстрая схема проверки

### Критические проверки (блокирующие)
```
1. Основная надпись присутствует
2. Формат листа соответствует стандарту
3. Масштаб указан корректно
4. Единицы измерения в СИ
5. Файл не поврежден
```

### Важные проверки (требуют исправления)
```
1. Заполнение всех обязательных полей
2. Стандартные размеры шрифтов
3. Правильные типы линий
4. Корректные обозначения
5. Качество изображения
```

### Рекомендации (улучшения)
```
1. Оптимальное расположение элементов
2. Единообразие оформления
3. Улучшение читаемости
4. Стандартизация обозначений
5. Оптимизация качества
```

---

## 🔄 Алгоритм проверки

### Шаг 1: Предварительная проверка
```
IF файл_загружен AND формат_поддерживается AND размер_корректный:
    ПРОДОЛЖИТЬ
ELSE:
    ОТКЛОНИТЬ с ошибкой
```

### Шаг 2: Извлечение данных
```
ПОКА данные_не_извлечены:
    ИЗВЛЕЧЬ текст_и_метаданные
    ПРОВЕРЬ качество_извлечения
    ЕСЛИ качество_низкое:
        ПРЕДУПРЕДИТЬ пользователя
```

### Шаг 3: Параллельная валидация
```
ЗАПУСТИТЬ_ПАРАЛЛЕЛЬНО:
    - ЕСКД_валидатор
    - СПДС_валидатор
    - Технический_валидатор
    - Качество_валидатор
```

### Шаг 4: Агрегация результатов
```
ДЛЯ каждой_категории:
    ВЫЧИСЛИТЬ балл_категории
    НАЙТИ критические_ошибки
    НАЙТИ серьезные_нарушения
    НАЙТИ предупреждения
```

### Шаг 5: Формирование отчета
```
ВЫЧИСЛИТЬ общий_балл
СОЗДАТЬ детальный_отчет
СФОРМИРОВАТЬ рекомендации
ОПРЕДЕЛИТЬ приоритеты_исправлений
```

---

## 📊 Метрики производительности

### Время выполнения
```
- Загрузка файла: < 5 секунд
- Извлечение данных: < 10 секунд
- Валидация: < 30 секунд
- Формирование отчета: < 5 секунд
- Общее время: < 50 секунд
```

### Точность проверки
```
- Извлечение текста: > 95%
- Распознавание элементов: > 90%
- Классификация ошибок: > 85%
- Общая точность: > 90%
```

---

## 🎯 Результат проверки

### Успешная проверка
```
✅ Документ соответствует стандартам
✅ Критических ошибок не найдено
✅ Балл соответствия > 80%
✅ Рекомендации по улучшению предоставлены
```

### Требует исправления
```
⚠️ Найдены серьезные нарушения
⚠️ Требуется исправление критических ошибок
⚠️ Балл соответствия 60-80%
⚠️ Детальные рекомендации предоставлены
```

### Несоответствие
```
❌ Критические ошибки блокируют приемку
❌ Документ не соответствует стандартам
❌ Балл соответствия < 60%
❌ Требуется полная переработка
```

---

**Дата создания:** 12 января 2025  
**Версия:** 1.0.0  
**Статус:** ✅ ЗАВЕРШЕНО  
**Готовность:** 🚀 ГОТОВ К ИСПОЛЬЗОВАНИЮ
